<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zerogravity.myapp.model.dao.DailyStaticsDao">

    <!-- 일일 감정 기록 조회 -->
    <select id="selectDailyStatics" parameterType="long" resultType="DailyStatics">
        SELECT * FROM daily_statics WHERE user_id = #{userId}    
    </select>
    
    <!-- 특정 날짜와 사용자 ID에 대한 일일 감정 기록 ID 조회 -->
    <select id="selectDailyStaticsByDateAndUserId" parameterType="map">
        SELECT * FROM daily_statics
        WHERE DATE(created_time) = DATE(#{createdTime}) AND user_id = #{userId}
    </select>
    
    <!-- 일일 감정 기록 삽입 -->
    <insert id="insertDailyStatics" parameterType="DailyStatics">
        INSERT INTO daily_statics (daily_statics_id, user_id, daily_sum, daily_count, daily_average, created_time, updated_time)
        VALUES (#{dailyStaticsId}, #{userId}, #{dailySum}, 1, #{dailyAverage}, #{createdTime}, #{createdTime})
    </insert>
    
    <!-- 일일 감정 기록 업데이트 -->
    <update id="updateDailyStatics" parameterType="DailyStatics">
        UPDATE daily_statics
        SET daily_sum = #{dailySum}, daily_count = #{dailyCount}, daily_average = #{dailyAverage}, updated_time = NOW()
        WHERE DATE(created_time) = DATE(#{createdTime}) AND user_id = #{userId}
    </update>

    
</mapper>
